<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh Thiếp 3D - Đặng Đức Đại</title>
    <style>
        /* --- PHẦN CSS (GIAO DIỆN) --- */
        body {
            margin: 0;
            overflow: hidden;
            background-color: #0d0d0d; /* Màu nền tối để làm nổi bật thẻ */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
        }

        #canvas-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1;
        }

        /* UI Overlay - Các thành phần nổi bên trên */
        .ui-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Để chuột xuyên qua bấm vào 3D được */
            z-index: 10;
        }

        /* Logo hoặc Tên Web góc trái */
        .brand {
            position: absolute;
            top: 30px;
            left: 30px;
            font-size: 1.5rem;
            font-weight: bold;
            letter-spacing: 2px;
            background: linear-gradient(90deg, #00c6ff, #0072ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Nút Kết Bạn / Action Button ở góc phải */
        .action-btn {
            position: absolute;
            bottom: 40px;
            right: 40px;
            pointer-events: auto; /* Bật lại tương tác chuột cho nút này */
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 15px 30px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 198, 255, 0.4);
        }

        .action-btn span {
            font-size: 1.2rem;
        }

        /* Hướng dẫn sử dụng nhỏ */
        .hint {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0.5;
            font-size: 0.9rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.3; }
            50% { opacity: 0.8; }
            100% { opacity: 0.3; }
        }
    </style>
</head>
<body>

    <div id="canvas-container"></div>

    <div class="ui-overlay">
        <div class="brand">NOXCODE CARD</div>
        <div class="hint">Di chuột để xoay thẻ</div>
        
        <button class="action-btn" onclick="alert('Đã gửi lời mời kết bạn tới Đức Đại!')">
            <span>➕</span> Kết Bạn Ngay
        </button>
    </div>

    <script type="module">
        import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';

        // --- PHẦN JAVASCRIPT (LOGIC 3D) ---

        // 1. KHỞI TẠO SCENE (SÂN KHẤU)
        const scene = new THREE.Scene();
        // Thêm sương mù nhẹ để tạo chiều sâu
        scene.fog = new THREE.FogExp2(0x0d0d0d, 0.05);

        // 2. CAMERA
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;

        // 3. RENDERER (BỘ DỰNG HÌNH)
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio); // Để nét trên màn hình retina/điện thoại
        renderer.shadowMap.enabled = true; // Bật đổ bóng
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        // 4. ÁNH SÁNG (QUAN TRỌNG ĐỂ TẠO ĐỘ LẤP LÁNH)
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        // Đèn chiếu điểm 1 (Màu xanh cyan)
        const pointLight1 = new THREE.PointLight(0x00c6ff, 2, 10);
        pointLight1.position.set(2, 2, 4);
        scene.add(pointLight1);

        // Đèn chiếu điểm 2 (Màu tím/hồng)
        const pointLight2 = new THREE.PointLight(0xff00ff, 2, 10);
        pointLight2.position.set(-2, -2, 4);
        scene.add(pointLight2);

        // 5. TẠO TEXTURE (HÌNH ẢNH TRÊN THẺ)
        // Vì mình ko dùng ảnh ngoài sợ lỗi link, mình sẽ vẽ ảnh bằng code (Canvas)
        function createCardTexture(text, role, subtext, color1, color2) {
            const canvas = document.createElement('canvas');
            canvas.width = 512;
            canvas.height = 300;
            const ctx = canvas.getContext('2d');

            // Nền Gradient
            const grd = ctx.createLinearGradient(0, 0, 512, 300);
            grd.addColorStop(0, color1);
            grd.addColorStop(1, color2);
            ctx.fillStyle = grd;
            ctx.fillRect(0, 0, 512, 300);

            // Viền
            ctx.strokeStyle = "rgba(255,255,255,0.5)";
            ctx.lineWidth = 10;
            ctx.strokeRect(10, 10, 492, 280);

            // Tên
            ctx.fillStyle = "white";
            ctx.font = "bold 60px Arial";
            ctx.textAlign = "center";
            ctx.fillText(text, 256, 120);

            // Chức danh
            ctx.font = "30px Arial";
            ctx.fillStyle = "#eeeeee";
            ctx.fillText(role, 256, 170);

            // Subtext (Thông tin thêm)
            ctx.font = "italic 20px Arial";
            ctx.fillStyle = "rgba(255,255,255,0.8)";
            ctx.fillText(subtext, 256, 250);

            return new THREE.CanvasTexture(canvas);
        }

        // Texture Mặt trước
        const frontTexture = createCardTexture("ĐẶNG ĐỨC ĐẠI", "IT STUDENT / GAMER", "Bach Khoa Univ - DUT", "#1a2a6c", "#b21f1f");
        
        // Texture Mặt sau
        const backTexture = createCardTexture("CONTACT ME", "NoxCode Project", "Quét QR hoặc bấm nút bên dưới", "#000000", "#434343");

        // 6. TẠO KHỐI 3D (CÁI THẺ)
        // BoxGeometry(rộng, cao, dày)
        const geometry = new THREE.BoxGeometry(3.4, 2, 0.05); 

        // Vật liệu (Material) - Dùng MeshPhysicalMaterial để có độ bóng như kim loại
        const materialFront = new THREE.MeshPhysicalMaterial({ 
            map: frontTexture,
            metalness: 0.7, // Độ kim loại cao
            roughness: 0.2, // Độ nhám thấp -> bóng loáng
            clearcoat: 1.0, // Lớp phủ bóng kính
            clearcoatRoughness: 0.1
        });

        const materialBack = new THREE.MeshPhysicalMaterial({ 
            map: backTexture,
            metalness: 0.7,
            roughness: 0.2,
            clearcoat: 1.0
        });

        const materialSide = new THREE.MeshPhysicalMaterial({ color: 0xffffff, metalness: 1, roughness: 0 });

        // Mảng vật liệu cho 6 mặt của hình hộp (Phải, Trái, Trên, Dưới, Trước, Sau)
        const materials = [
            materialSide, materialSide, materialSide, materialSide, 
            materialFront, // Mặt trước
            materialBack   // Mặt sau
        ];

        const card = new THREE.Mesh(geometry, materials);
        scene.add(card);

        // 7. XỬ LÝ SỰ KIỆN CHUỘT (INTERACTION)
        let mouseX = 0;
        let mouseY = 0;
        let targetRotationX = 0;
        let targetRotationY = 0;

        const windowHalfX = window.innerWidth / 2;
        const windowHalfY = window.innerHeight / 2;

        document.addEventListener('mousemove', (event) => {
            // Tính toán vị trí chuột so với tâm màn hình (-1 đến 1)
            mouseX = (event.clientX - windowHalfX) / 1000; // Chia lớn để giảm độ nhạy
            mouseY = (event.clientY - windowHalfY) / 1000;
        });
        
        // Hỗ trợ cảm ứng trên điện thoại
        document.addEventListener('touchmove', (event) => {
             if (event.touches.length > 0) {
                mouseX = (event.touches[0].clientX - windowHalfX) / 1000;
                mouseY = (event.touches[0].clientY - windowHalfY) / 1000;
             }
        }, { passive: false });


        // 8. VÒNG LẶP ANIMATION (GAME LOOP)
        function animate() {
            requestAnimationFrame(animate);

            // Hiệu ứng "Lướt" (Easing) - Thẻ sẽ đi theo chuột từ từ chứ không giật cục
            targetRotationX = mouseY * 5; // Xoay trục X theo chuột Y
            targetRotationY = mouseX * 5; // Xoay trục Y theo chuột X

            // Công thức nội suy tuyến tính (Lerp) để làm mượt chuyển động
            card.rotation.x += 0.05 * (targetRotationX - card.rotation.x);
            card.rotation.y += 0.05 * (targetRotationY - card.rotation.y);

            // Thêm chút chuyển động tự nhiên (nhấp nhô nhẹ)
            card.position.y = Math.sin(Date.now() * 0.001) * 0.1;

            // Di chuyển đèn để tạo hiệu ứng lấp lánh chạy qua thẻ
            pointLight1.position.x = Math.sin(Date.now() * 0.001) * 5;
            pointLight1.position.y = Math.cos(Date.now() * 0.001) * 5;

            renderer.render(scene, camera);
        }

        // 9. XỬ LÝ KHI RESIZE MÀN HÌNH
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // Bắt đầu chạy
        animate();

    </script>
</body>
</html>
